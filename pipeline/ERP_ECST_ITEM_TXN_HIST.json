{
	"name": "ERP_ECST_ITEM_TXN_HIST",
	"properties": {
		"activities": [
			{
				"name": "Copy data1",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "OracleSource",
						"oracleReaderQuery": {
							"value": "SELECT    YYYYMM\n     ,    ORGANIZATION_ID\n     ,    SUBINVENTORY_CODE\n     ,    INVENTORY_ITEM_ID\n     ,    PROJECT_ID\n     ,    TASK_ID\n     ,    LAST_YEAR_QTY_ONHAND\n     ,    LAST_YEAR_AMT_ONHAND\n     ,    BEF_QTY_ONHAND\n     ,    QTY_PO_RECEIPT\n     ,    QTY_WIP_RECEIPT\n     ,    QTY_OTHER_RECEIPT\n     ,    QTY_WIP_ISSUE\n     ,    QTY_SALES_ISSUE\n     ,    QTY_OTHER_ISSUE\n     ,    QTY_ONHAND\n     ,    BEF_AMT_M_ONHAND\n     ,    BEF_AMT_MOVH_ONHAND\n     ,    BEF_AMT_RSC_ONHAND\n     ,    BEF_AMT_OSP_ONHAND\n     ,    BEF_AMT_OVH_ONHAND\n     ,    BEF_AMT_ONHAND\n     ,    AMT_PO_M_RECEIPT\n     ,    AMT_PO_MOVH_RECEIPT\n     ,    AMT_PO_RSC_RECEIPT\n     ,    AMT_PO_OSP_RECEIPT\n     ,    AMT_PO_OVH_RECEIPT\n     ,    AMT_PO_RECEIPT\n     ,    AMT_WIP_M_RECEIPT\n     ,    AMT_WIP_MOVH_RECEIPT\n     ,    AMT_WIP_RSC_RECEIPT\n     ,    AMT_WIP_OSP_RECEIPT\n     ,    AMT_WIP_OVH_RECEIPT\n     ,    AMT_WIP_RECEIPT\n     ,    AMT_OTHER_M_RECEIPT\n     ,    AMT_OTHER_MOVH_RECEIPT\n     ,    AMT_OTHER_RSC_RECEIPT\n     ,    AMT_OTHER_OSP_RECEIPT\n     ,    AMT_OTHER_OVH_RECEIPT\n     ,    AMT_OTHER_RECEIPT\n     ,    AMT_WIP_M_ISSUE\n     ,    AMT_WIP_MOVH_ISSUE\n     ,    AMT_WIP_RSC_ISSUE\n     ,    AMT_WIP_OSP_ISSUE\n     ,    AMT_WIP_OVH_ISSUE\n     ,    AMT_WIP_ISSUE\n     ,    AMT_SALES_M_ISSUE\n     ,    AMT_SALES_MOVH_ISSUE\n     ,    AMT_SALES_RSC_ISSUE\n     ,    AMT_SALES_OSP_ISSUE\n     ,    AMT_SALES_OVH_ISSUE\n     ,    AMT_SALES_ISSUE\n     ,    AMT_OTHER_M_ISSUE\n     ,    AMT_OTHER_MOVH_ISSUE\n     ,    AMT_OTHER_RSC_ISSUE\n     ,    AMT_OTHER_OSP_ISSUE\n     ,    AMT_OTHER_OVH_ISSUE\n     ,    AMT_OTHER_ISSUE\n     ,    AMT_M_ONHAND\n     ,    AMT_MOVH_ONHAND\n     ,    AMT_RSC_ONHAND\n     ,    AMT_OSP_ONHAND\n     ,    AMT_OVH_ONHAND\n     ,    AMT_ONHAND\n     ,    CORRECT_FLAG\n     ,    CORRECT_AMT\n     ,    CORRECT_DESC\n     ,    LAST_RECEIPT_DATE\n     ,    LAST_RECEIPT_DATE_ON\n     ,    LAST_ISSUE_DATE\n     ,    LAST_ISSUE_DATE_ON\n     ,    ITEM_LAST_RECEIPT_DATE\n     ,    ITEM_LAST_RECEIPT_DATE_ON\n     ,    ITEM_LAST_ISSUE_DATE\n     ,    ITEM_LAST_ISSUE_DATE_ON\n     ,    ATTRIBUTE1\n     ,    ATTRIBUTE2\n     ,    ATTRIBUTE3\n     ,    ATTRIBUTE4\n     ,    ATTRIBUTE5\n     ,    LAST_UPDATE_DATE\n     ,    LAST_UPDATED_BY\n     ,    CREATION_DATE\n     ,    CREATED_BY\n     ,    QTY_SUBTRANS_RECEIPT\n     ,    QTY_SUBTRANS_ISSUE\n     ,    AMT_SUBTRANS_M_RECEIPT\n     ,    AMT_SUBTRANS_MOVH_RECEIPT\n     ,    AMT_SUBTRANS_RSC_RECEIPT\n     ,    AMT_SUBTRANS_OSP_RECEIPT\n     ,    AMT_SUBTRANS_OVH_RECEIPT\n     ,    AMT_SUBTRANS_RECEIPT\n     ,    AMT_SUBTRANS_M_ISSUE\n     ,    AMT_SUBTRANS_MOVH_ISSUE\n     ,    AMT_SUBTRANS_RSC_ISSUE\n     ,    AMT_SUBTRANS_OSP_ISSUE\n     ,    AMT_SUBTRANS_OVH_ISSUE\n     ,    AMT_SUBTRANS_ISSUE\n     ,    'Y' IF_RESULT\n     ,    NULL IF_TRC_ID\n     ,    SYSDATE IF_DATE\n  FROM    ECST_ITEM_TXN_HISTORIES\n WHERE    YYYYMM >= TO_CHAR(TRUNC(SYSDATE-1),'YYYYMM')-1\n   AND    ORGANIZATION_ID IN (102\n,103\n,104\n,105\n,111\n,121\n,321\n,541\n,542\n,564\n)",
							"type": "Expression"
						},
						"partitionOption": "None",
						"convertDecimalToInteger": false,
						"queryTimeout": "02:00:00"
					},
					"sink": {
						"type": "SqlDWSink",
						"preCopyScript": "DELETE [ERPSYS].[ERP_ECST_ITEM_TXN_HIST] WHERE YYYYMM >= CONVERT(NVARCHAR(6),DATEADD(MONTH,-1,GETDATE()),112)",
						"allowCopyCommand": true,
						"tableOption": "autoCreate",
						"disableMetricsCollection": false
					},
					"enableStaging": true,
					"stagingSettings": {
						"linkedServiceName": {
							"referenceName": "databrickslspocsa",
							"type": "LinkedServiceReference"
						},
						"path": "synapse-fs"
					}
				},
				"inputs": [
					{
						"referenceName": "DS_FRW_ORACLE_ALL",
						"type": "DatasetReference",
						"parameters": {
							"SRC_SRV_NM": {
								"value": "@pipeline().parameters.SRC_SRV_NM",
								"type": "Expression"
							},
							"SRC_PORT_NM": {
								"value": "@pipeline().parameters.SRC_PORT_NM",
								"type": "Expression"
							},
							"SRC_DB_NM": {
								"value": "@pipeline().parameters.SRC_DB_NM",
								"type": "Expression"
							},
							"SRC_USER_NM": {
								"value": "@pipeline().parameters.SRC_USER_NM",
								"type": "Expression"
							},
							"SRC_DB_KVS_NM": {
								"value": "@pipeline().parameters.SRC_DB_KVS_NM",
								"type": "Expression"
							}
						}
					}
				],
				"outputs": [
					{
						"referenceName": "DS_FRW_ADW_TBL",
						"type": "DatasetReference",
						"parameters": {
							"SRC_SRV_NM": {
								"value": "@pipeline().parameters.DST_SRV_NM",
								"type": "Expression"
							},
							"SRC_DB_NM": {
								"value": "@pipeline().parameters.DST_DB_NM",
								"type": "Expression"
							},
							"SRC_USER_NM": {
								"value": "@pipeline().parameters.DST_USER_NM",
								"type": "Expression"
							},
							"SRC_DB_KVS_NM": {
								"value": "@pipeline().parameters.DST_DB_KVS_NM",
								"type": "Expression"
							},
							"SCHEMA_NM": "ERPSYS",
							"TABLE_NM": {
								"value": "@pipeline().Pipeline",
								"type": "Expression"
							}
						}
					}
				]
			}
		],
		"parameters": {
			"SRC_SRV_NM": {
				"type": "string",
				"defaultValue": "165.244.241.132"
			},
			"SRC_PORT_NM": {
				"type": "string",
				"defaultValue": "1601"
			},
			"SRC_DB_NM": {
				"type": "string",
				"defaultValue": "ERPPROD"
			},
			"SRC_USER_NM": {
				"type": "string",
				"defaultValue": "LSISDATALAKE"
			},
			"SRC_DB_KVS_NM": {
				"type": "string",
				"defaultValue": "PROD-KVS-FRW-ERP-ORACLE"
			},
			"DST_SRV_NM": {
				"type": "string",
				"defaultValue": "synw-datawarehouse-prod-001.sql.azuresynapse.net"
			},
			"DST_DB_NM": {
				"type": "string",
				"defaultValue": "syndpdatawarehouse"
			},
			"DST_USER_NM": {
				"type": "string",
				"defaultValue": "sqladminuser"
			},
			"DST_DB_KVS_NM": {
				"type": "string",
				"defaultValue": "PROD-KVS-FRW-ADW-SYN"
			}
		},
		"folder": {
			"name": "2ND PROJECT/2. NONE EAI/1. ORACLE"
		},
		"annotations": [],
		"lastPublishTime": "2025-06-04T06:05:22Z"
	}
}